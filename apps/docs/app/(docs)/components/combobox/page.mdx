import { Cards } from "@/components/cards";
import { Demo } from "@/components/demo";
import { PropsTable } from "@/components/props-table";

# Combobox

Multi-purpose combobox widget to allow selection from a dynamic set of options.

<Demo component="combobox/usage" />

## Guide

### Structure

Combobox works with lists of items provided via the `defaultItems` prop. The basic structure includes the main component provider, a trigger, and a content.

- `Combobox`
- `ComboboxTrigger`
- `ComboboxContent`

Items can be an array of strings or it can be an array of objects.

The trigger can be provided a `placeholder` to display in case no values have been selected yet.

<Demo component="combobox/overview/usage" />

The `ComboboxContent` component further includes the input, a listbox, and a footer.

- `ComboboxInput`
- `ComboboxListbox`
- `ComboboxFooter`

We'll talk about them more in the following sections.

### Listbox

By default content popover will render an input and the provided items. But we can customize how items are rendered using the `ComboboxListbox` component.

`ComboboxListbox` accepts a react node as well as a render prop where the first parameter is the item that needs to be rendered.

<Demo component="combobox/overview/content-usage" meta="{15}" />

#### Single-select

We can render single-select items using `ComboboxRadioItem`.

<Demo component="combobox/overview/content-radio-usage" meta="{19}" />

#### Multi-select

We can render multi-select items using `ComboboxCheckboxItem`.

<Demo component="combobox/overview/content-checkbox-usage" meta="{19-21}" />

### Input

Notice that keyboard interactions inside the content popover do not work in the previous demos. This is because we need to render the `ComboboxInput` component that handles keyboard interaction and triggers filtering of visible items.

<Demo component="combobox/overview/input-usage" meta="{16}" />

#### Filtering

Combobox automatically handles filtering items when using the `defaultItems` prop. But if we need manual control we can use `items` prop instead along with `onInputValueChange`.

<Demo component="combobox/overview/input-controlled-usage" meta="{17-26}" />

How you store the items and handle filtering is up to you. In the previous demo we've stored the items in a state and update the state in the `onInputValueChange` handler. Alternatively you could store the input value in a state and filter the items based on that on each render.

<Demo
  component="combobox/overview/input-controlled-input-usage"
  meta="{13-18,22}"
/>

### Selection

Pressing enter or clicking items will not do anything in previous demos. For that we need to add the `isItemSelected` and `onItemSelect` props to the main `Combobox` component.

#### Single-select

<Demo component="combobox/overview/value-radio-usage" meta="{13,18-21}" />

#### Multi-select

<Demo component="combobox/overview/value-checkbox-usage" meta="{16,21-28}" />

### Empty

Finally we can render an empty state in the content using the `ComboboxEmpty` component. And you also have to use the `items` prop when manually rendering the empty state.

<Demo component="combobox/overview/empty-usage" meta="{41-43}" />

## Documentation

### Anatomy

```tsx
import {
  Combobox,
  ComboboxCheckboxItem,
  ComboboxContent,
  ComboboxEmpty,
  ComboboxFooter,
  ComboboxGroup,
  ComboboxInput,
  ComboboxItem,
  ComboboxLabel,
  ComboboxListbox,
  ComboboxRadioItem,
  ComboboxSeparator,
  ComboboxTrigger,
} from "@optiaxiom/react";

export default () => (
  <Combobox>
    <ComboboxTrigger />

    <ComboboxContent>
      <ComboboxInput />

      <ComboboxListbox>
        <ComboboxItem />
        <ComboboxCheckboxItem />
        <ComboboxRadioItem />

        <ComboboxGroup>
          <ComboboxLabel />
          <ComboboxItem />
          <ComboboxCheckboxItem />
          <ComboboxRadioItem />
        </ComboboxGroup>

        <ComboboxSeparator />
        <ComboboxEmpty />
      </ComboboxListbox>

      <ComboboxFooter />
    </ComboboxContent>
  </Combobox>
);
```

### Data

Use the `defaultItems` or `items` prop to pass the collection of data to `Combobox`. Items can be an array of primitive types such as strings or it can be an array of objects.

In case item is an object you need to pass an additional `itemToLabel` prop for `Combobox` to work.

<Demo component="combobox/complex-usage" meta={{ "App.tsx": "{26}" }} />

### Filtering

Use the `onInputValueChange` handler to handle filtering your list of items as the user is typing.

<Demo component="combobox/complex-usage" meta={{ "App.tsx": "{25-33}" }} />

### Selection

We can only specify `Combobox` selection in a controlled mode and using the following props:

- `isItemSelected`: Return true if an item should be marked as selected where the item and the index are passed as parameters.
- `onItemSelect`: Handler invoked when user selects an item with the item as the only parameter.

Developers are expected to manually track the selection on their side since items inside a combobox can represent values or actions.

<Demo
  component="combobox/controlled-usage"
  meta={{ "App.tsx": "{16,21,23}" }}
/>

### Disabled

Use the optional `isItemDisabled` prop to configure which items should be disabled. The callback is passed the item and the index number as arguments and expects a boolean result.

<Demo
  component="combobox/complex-usage"
  meta={{ "App.tsx": "{22}", "data.ts": "{3}" }}
/>

### Creatable

We can combine filtering and controlled usage to build **creatable** comboboxes by allowing the user to add new entries on the fly.

<Demo component="combobox/creatable-usage" />

### Trigger

By default we use the `Button` component for the combobox trigger which accepts all of the existing button props.

### Item

The `ComboboxCheckboxItem` component accepts `icon`, `addonBefore`, `addonAfter`, and `description` props for additional content inside the items.

<Demo component="combobox/complex-usage" meta={{ "App.tsx": "{53-58}" }} />

### Empty

Use the `ComboboxEmpty` component when there are no available items or suggestions.

<Demo component="combobox/complex-usage" meta={{ "App.tsx": "{65-67}" }} />

### Loading

Use the `loading` prop on `ComboboxListbox` to show a loading spinner if the initial data for the combobox has not loaded yet.

<Demo component="combobox/loading-usage" meta={{ "App.tsx": "{42}" }} />

### Virtualized

We can use virtualization to improve performance when rendering a large number of items inside the combobox. Inside `ComboboxListbox` set `children` to a render prop to enable virtualization.

<Demo component="combobox/virtualized-usage" meta="{49-55}" />

### Related

<Cards items={["DropdownMenu", "Select"]} />

## Props

### Combobox

<PropsTable component="Combobox" />
### ComboboxTrigger
<PropsTable component="ComboboxTrigger" />
### ComboboxContent
<PropsTable component="ComboboxContent" />
### ComboboxInput
<PropsTable component="ComboboxInput" />
### ComboboxListbox
<PropsTable component="ComboboxListbox" />
### ComboboxItem
<PropsTable component="ComboboxItem" />
### ComboboxCheckboxItem
<PropsTable component="ComboboxCheckboxItem" />
### ComboboxRadioItem
<PropsTable component="ComboboxRadioItem" />
### ComboboxGroup
<PropsTable component="ComboboxGroup" />
### ComboboxLabel
<PropsTable component="ComboboxLabel" />
### ComboboxSeparator
<PropsTable component="ComboboxSeparator" />
### ComboboxEmpty
<PropsTable component="ComboboxEmpty" />
### ComboboxFooter
<PropsTable component="ComboboxFooter" />

## Changelog

### 0.4.0

- Added component
